E:\node-project\challenge-backend>npm run test:e2e

> challenge-backend@0.0.1 test:e2e
> jest --config ./test/jest-e2e.json

 FAIL  test/users.e2e-spec.ts (9.262 s)   
  ● UsersModule (e2e) › DELETE /api/users/me › [Sukses] Menghapus akun sendiri dengan token yang valid.  

    expect(received).toBe(expected) // Object.is equality

    Expected: 204
    Received: 401

      118 |         .set('Authorization', `Bearer ${accessToken}`);
      119 |
    > 120 |       expect(deleteResponse.status).toBe(HttpStatus.NO_CONTENT);
          |                                     ^
      121 |
      122 |       // Verify user is deleted by trying to log in
      123 |       const loginAttemptAfterDelete = await loginUser(app, {

      at Object.<anonymous> (users.e2e-spec.ts:120:37)

 PASS  test/auth.e2e-spec.ts
 PASS  test/app.e2e-spec.ts
 FAIL  test/tasks.e2e-spec.ts (17.36 s)      
  ● Console

    console.log
      log tasks headers {
        'x-powered-by': 'Express',
        'content-type': 'application/json; charset=utf-8',
        'content-length': '43',
        etag: 'W/"2b-dGnJzt6gv1nJjX6DJ9RztDWptng"',       
        date: 'Sat, 07 Feb 2026 14:46:57 GMT',
        connection: 'close'
      }

      at Object.<anonymous> (tasks.e2e-spec.ts:141:15)

  ● TasksModule (e2e) › POST /api/tasks › [Sukses] Pengguna A membuat tugas baru dengan data yang valid. 

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 401

      83 |         .send(createTaskDto);
      84 |
    > 85 |       expect(response.status).toBe(HttpStatus.CREATED);
         |                               ^
      86 |       expect(response.body).toBeDefined();
      87 |       expect(response.body.title).toBe(createTaskDto.title);
      88 |       expect(response.body.description).toBe(createTaskDto.description);

      at Object.<anonymous> (tasks.e2e-spec.ts:85:31)

  ● TasksModule (e2e) › POST /api/tasks › [Gagal] Membuat tugas dengan data yang tidak valid (misalnya, judul kosong).

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tasks.e2e-spec.ts:55:21)

  ● TasksModule (e2e) › POST /api/tasks › [Gagal] Membuat tugas tanpa token autentikasi.

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tasks.e2e-spec.ts:55:21)

  ● TasksModule (e2e) › GET /api/tasks › [Sukses] Pengguna A mengambil daftar tugasnya.

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      141 |       console.log('log tasks headers', response.headers);
      142 |
    > 143 |       expect(response.status).toBe(HttpStatus.OK);
          |                               ^
      144 |       expect(response.body).toBeInstanceOf(Array);
      145 |       expect(response.body.length).toBe(2);
      146 |       expect(response.body.map((task) => task.title)).toEqual(

      at Object.<anonymous> (tasks.e2e-spec.ts:143:31)

  ● TasksModule (e2e) › GET /api/tasks › [Sukses] Pengguna yang belum punya tugas mengambil daftar tugasnya.

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tasks.e2e-spec.ts:55:21)

  ● TasksModule (e2e) › GET /api/tasks/:id › [Gagal] Pengguna A mengambil detail tugas yang tidak ada (ID salah).

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tasks.e2e-spec.ts:67:21)

  ● TasksModule (e2e) › PATCH /api/tasks/:id › [Gagal] Pengguna A memperbarui tugas yang tidak ada (ID salah).

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tasks.e2e-spec.ts:67:21)

  ● TasksModule (e2e) › DELETE /api/tasks/:id › [Sukses] Pengguna A menghapus tugas miliknya.

    expect(received).toBe(expected) // Object.is equality

    Expected: 204
    Received: 401

      327 |         .set('Authorization', `Bearer ${userAToken}`);
      328 |
    > 329 |       expect(response.status).toBe(HttpStatus.NO_CONTENT);
          |                               ^
      330 |
      331 |       // Verify the task is deleted
      332 |       const getResponse = await request(app.getHttpServer())

      at Object.<anonymous> (tasks.e2e-spec.ts:329:31)

  ● TasksModule (e2e) › DELETE /api/tasks/:id › [Gagal] Pengguna B mencoba menghapus tugas milik Pengguna A.

    expect(received).toBe(expected) // Object.is equality

    Expected: 401
    Received: 404

      341 |         .set('Authorization', `Bearer ${userBToken}`);
      342 |
    > 343 |       expect(response.status).toBe(HttpStatus.UNAUTHORIZED);
          |                               ^
      344 |     });
      345 |
      346 |     it('[Gagal] Pengguna A menghapus tugas yang tidak ada (ID salah).', async () => {        

      at Object.<anonymous> (tasks.e2e-spec.ts:343:31)

 FAIL  test/tags.e2e-spec.ts (20.541 s)
  ● TagsModule (e2e) › POST /api/tags › [Sukses] Pengguna A membuat tag baru dengan data yang valid.     

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tags.e2e-spec.ts:67:21)

  ● TagsModule (e2e) › POST /api/tags › [Gagal] Membuat tag dengan nama yang duplikat untuk pengguna yang sama.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tags.e2e-spec.ts:67:21)

  ● TagsModule (e2e) › POST /api/tags › [Gagal] Membuat tag tanpa token autentikasi.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tags.e2e-spec.ts:67:21)

  ● TagsModule (e2e) › GET /api/tags › [Sukses] Pengguna A mengambil daftar tag-nya.

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tags.e2e-spec.ts:55:21)

  ● TagsModule (e2e) › GET /api/tags/:id › [Gagal] Pengguna B mencoba mengambil detail tag milik Pengguna A.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tags.e2e-spec.ts:67:21)

  ● TagsModule (e2e) › PATCH /api/tags/:id › [Sukses] Pengguna A memperbarui tag miliknya.

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      215 |         .send(updateTagDto);
      216 |
    > 217 |       expect(response.status).toBe(HttpStatus.OK);
          |                               ^
      218 |       expect(response.body).toBeDefined();
      219 |       expect(response.body.id).toBe(userATagId);
      220 |       expect(response.body.name).toBe(updateTagDto.name);

      at Object.<anonymous> (tags.e2e-spec.ts:217:31)

  ● TagsModule (e2e) › PATCH /api/tags/:id › [Gagal] Memperbarui dengan nama tag duplikat untuk pengguna 
yang sama.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tags.e2e-spec.ts:67:21)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › POST /api/tags/:tagId/tasks/:taskId › [Sukses] Mengaitkan tag milik Pengguna A dengan tugas milik Pengguna A.

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 404

      341 |           .set('Authorization', `Bearer ${userAToken}`);
      342 |
    > 343 |         expect(response.status).toBe(HttpStatus.CREATED);
          |                                 ^
      344 |
      345 |         // Verify association by fetching the task and checking its tags
      346 |         const taskResponse = await request(app.getHttpServer())

      at Object.<anonymous> (tags.e2e-spec.ts:343:33)

Test Suites: 3 failed, 2 passed, 5 total
Tests:       18 failed, 36 passed, 54 total
Snapshots:   0 total
Time:        23.08 s
Ran all test suites.