Prisma schema loaded from prisma\schema.prisma.
Datasource "db": SQLite database "data.db" at "file:./prisma/data.db"

√ Are you sure you want to reset your database? All data will be lost. ... yes

Applying migration `20260207071242_init`

Database reset successful

The following migration(s) have been applied:

migrations/
  └─ 20260207071242_init/
    └─ migration.sql


E:\node-project\challenge-backend>npm run test:e2e

> challenge-backend@0.0.1 test:e2e
> jest --config ./test/jest-e2e.json

 FAIL  test/users.e2e-spec.ts (18.394 s)
  ● UsersModule (e2e) › PATCH /api/users/me › [Sukses] Memperbarui nama dan tanggal lahir dengan data yang valid.

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      79 |         .send(updateUserDto);
      80 |
    > 81 |       expect(response.status).toBe(HttpStatus.OK);
         |                               ^
      82 |       expect(response.body).toBeDefined();
      83 |       expect(response.body.name).toBe(updateUserDto.name);
      84 |       expect(new Date(response.body.birth).toISOString()).toBe(

      at Object.<anonymous> (users.e2e-spec.ts:81:31)

  ● UsersModule (e2e) › PATCH /api/users/me › [Gagal] Memperbarui dengan data yang tidak valid (misalnya, nama bukan string).

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 401

      105 |         .send(invalidUpdateUserDto);
      106 |
    > 107 |       expect(response.status).toBe(HttpStatus.BAD_REQUEST);
          |                               ^
      108 |       expect(response.body.message).toEqual(
      109 |         expect.arrayContaining(['name must be a string']),
      110 |       );

      at Object.<anonymous> (users.e2e-spec.ts:107:31)

 PASS  test/auth.e2e-spec.ts (7.044 s)     
[Nest] 20152  - 02/07/2026, 3:58:06 PM   ERROR [ExceptionsHandler] PrismaClientKnownRequestError:        
Invalid `this.prisma.tag.update()` invocation in
E:\node-project\challenge-backend\src\tags\tags.service.ts:69:30

  66 }
  67
  68 try {
→ 69   return this.prisma.tag.update(
Unique constraint failed on the fields: (`userId`, `name`)
    at Vr.handleRequestError (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:228:13)
    at Vr.handleAndLogRequestError (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:174:12)
    at Vr.request (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:143:12)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at a (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\getPrismaClient.ts:805:24)
    at E:\node-project\challenge-backend\node_modules\@nestjs\core\router\router-execution-context.js:46:28
    at E:\node-project\challenge-backend\node_modules\@nestjs\core\router\router-proxy.js:9:17 {
  code: 'P2002',
  meta: {
    modelName: 'Tag',
    driverAdapterError: DriverAdapterError: UniqueConstraintViolation
        at PrismaBetterSqlite3Adapter.onError (E:\node-project\challenge-backend\node_modules\@prisma\adapter-better-sqlite3\dist\index.js:568:11)
        at PrismaBetterSqlite3Adapter.performIO (E:\node-project\challenge-backend\node_modules\@prisma\adapter-better-sqlite3\dist\index.js:563:12)
        at PrismaBetterSqlite3Adapter.queryRaw (E:\node-project\challenge-backend\node_modules\@prisma\adapter-better-sqlite3\dist\index.js:504:63)
        at E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:184:16
        at callback (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\tracing.ts:80:12)
        at e.withQuerySpanAndEvent (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:363:12)
        at e.#withQuerySpanAndEvent [as interpretNode] (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:182:37)
        at e.interpretNode (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:209:52)
        at e.interpretNode (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:124:40)
        at e.interpretNode (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:268:52)
        at e.run (E:\node-project\challenge-backend\node_modules\@prisma\client-engine-runtime\src\interpreter\query-interpreter.ts:93:34)
        at execute (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\core\engines\client\LocalExecutor.ts:81:36)
        at Dt.request (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\core\engines\client\ClientEngine.ts:461:37)
        at processTicksAndRejections (node:internal/process/task_queues:105:5)
        at Object.singleLoader (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:112:26)
        at Vr.request (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:140:14)
        at a (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\getPrismaClient.ts:805:24)
        at E:\node-project\challenge-backend\node_modules\@nestjs\core\router\router-execution-context.js:46:28
        at E:\node-project\challenge-backend\node_modules\@nestjs\core\router\router-proxy.js:9:17 {     
      cause: {
        originalCode: 'SQLITE_CONSTRAINT_UNIQUE',
        originalMessage: 'UNIQUE constraint failed: Tag.userId, Tag.name',
        kind: 'UniqueConstraintViolation',
        constraint: {
          fields: [
            'userId',
            'name'
          ]
        }
      }
    }
  },
  clientVersion: '7.3.0'
}
[Nest] 20152  - 02/07/2026, 3:58:07 PM   ERROR [ExceptionsHandler] PrismaClientKnownRequestError:        
Invalid `this.prisma.tag.delete()` invocation in
E:\node-project\challenge-backend\src\tags\tags.service.ts:98:33

  95   );
  96 }
  97
→ 98 await this.prisma.tag.delete(
An operation failed because it depends on one or more records that were required but not found. No record was found for a delete.
    at Vr.handleRequestError (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:228:13)
    at Vr.handleAndLogRequestError (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:174:12)
    at Vr.request (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\RequestHandler.ts:143:12)
    at processTicksAndRejections (node:internal/process/task_queues:105:5)
    at a (E:\node-project\challenge-backend\node_modules\@prisma\client\src\runtime\getPrismaClient.ts:805:24)
    at TagsService.remove (E:\node-project\challenge-backend\src\tags\tags.service.ts:98:5)
    at E:\node-project\challenge-backend\node_modules\@nestjs\core\router\router-execution-context.js:46:28
    at E:\node-project\challenge-backend\node_modules\@nestjs\core\router\router-proxy.js:9:17 {
  code: 'P2025',
  meta: {
    modelName: 'Tag',
    operation: 'a delete'
  },
  clientVersion: '7.3.0'
}
 PASS  test/app.e2e-spec.ts
 FAIL  test/tasks.e2e-spec.ts (34.005 s)
  ● TasksModule (e2e) › POST /api/tasks › [Sukses] Pengguna A membuat tugas baru dengan data yang valid. 

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 401

      83 |         .send(createTaskDto);
      84 |
    > 85 |       expect(response.status).toBe(HttpStatus.CREATED);
         |                               ^
      86 |       expect(response.body).toBeDefined();
      87 |       expect(response.body.title).toBe(createTaskDto.title);
      88 |       expect(response.body.description).toBe(createTaskDto.description);

      at Object.<anonymous> (tasks.e2e-spec.ts:85:31)

  ● TasksModule (e2e) › POST /api/tasks › [Gagal] Membuat tugas dengan data yang tidak valid (misalnya, judul kosong).

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tasks.e2e-spec.ts:55:21)

  ● TasksModule (e2e) › GET /api/tasks › [Sukses] Pengguna A mengambil daftar tugasnya.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tasks.e2e-spec.ts:67:21)

  ● TasksModule (e2e) › GET /api/tasks › [Gagal] Mengambil daftar tugas tanpa token autentikasi.

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tasks.e2e-spec.ts:55:21)

  ● TasksModule (e2e) › GET /api/tasks/:id › [Sukses] Pengguna A mengambil detail tugas miliknya.        

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tasks.e2e-spec.ts:67:21)

  ● TasksModule (e2e) › GET /api/tasks/:id › [Gagal] Pengguna A mengambil detail tugas yang tidak ada (ID salah).

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      214 |         .set('Authorization', `Bearer ${userAToken}`);
      215 |
    > 216 |       expect(response.status).toBe(HttpStatus.NOT_FOUND);
          |                               ^
      217 |       expect(response.body.message).toBe('Task not found');
      218 |     });
      219 |

      at Object.<anonymous> (tasks.e2e-spec.ts:216:31)

  ● TasksModule (e2e) › GET /api/tasks/:id › [Gagal] Pengguna B mencoba mengambil detail tugas milik Pengguna A.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tasks.e2e-spec.ts:67:21)

  ● TasksModule (e2e) › GET /api/tasks/:id › [Gagal] Mengambil detail tugas tanpa token autentikasi.     

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tasks.e2e-spec.ts:55:21)

  ● TasksModule (e2e) › PATCH /api/tasks/:id › [Sukses] Pengguna A memperbarui tugas miliknya.

    TypeError: Cannot read properties of null (reading 'id')

      65 |       where: { email: userBRegisterDto.email },
      66 |     });
    > 67 |     userBId = userB.id;
         |                     ^
      68 |   });
      69 |
      70 |   afterAll(async () => {

      at Object.<anonymous> (tasks.e2e-spec.ts:67:21)

  ● TasksModule (e2e) › PATCH /api/tasks/:id › [Gagal] Pengguna A memperbarui tugas yang tidak ada (ID salah).

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      288 |         .send(updateTaskDto);
      289 |
    > 290 |       expect(response.status).toBe(HttpStatus.NOT_FOUND);
          |                               ^
      291 |       expect(response.body.message).toBe('Task not found');
      292 |     });
      293 |

      at Object.<anonymous> (tasks.e2e-spec.ts:290:31)

 FAIL  test/tags.e2e-spec.ts (37.882 s)
  ● TagsModule (e2e) › POST /api/tags › [Gagal] Membuat tag dengan nama yang duplikat untuk pengguna yang sama.

    expect(received).toBe(expected) // Object.is equality

    Expected: 409
    Received: 401

       98 |         .send(createTagDto);
       99 |
    > 100 |       expect(response.status).toBe(HttpStatus.CONFLICT);
          |                               ^
      101 |       expect(response.body.message).toBe(
      102 |         'Tag with this name already exists for this user',
      103 |       );

      at Object.<anonymous> (tags.e2e-spec.ts:100:31)

  ● TagsModule (e2e) › GET /api/tags › [Sukses] Pengguna A mengambil daftar tag-nya.

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      137 |         .set('Authorization', `Bearer ${userAToken}`);
      138 |
    > 139 |       expect(response.status).toBe(HttpStatus.OK);
          |                               ^
      140 |       expect(response.body).toBeInstanceOf(Array);
      141 |       expect(response.body.length).toBe(2);
      142 |       expect(response.body.map((tag) => tag.name)).toEqual(

      at Object.<anonymous> (tags.e2e-spec.ts:139:31)

  ● TagsModule (e2e) › GET /api/tags/:id › [Sukses] Pengguna A mengambil detail tag miliknya.

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 401

      171 |         .set('Authorization', `Bearer ${userAToken}`);
      172 |
    > 173 |       expect(response.status).toBe(HttpStatus.OK);
          |                               ^
      174 |       expect(response.body).toBeDefined();
      175 |       expect(response.body.id).toBe(userATagId);
      176 |       expect(response.body.name).toBe('Important');

      at Object.<anonymous> (tags.e2e-spec.ts:173:31)

  ● TagsModule (e2e) › GET /api/tags/:id › [Gagal] Mengambil detail tag yang tidak ada.

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      192 |         .set('Authorization', `Bearer ${userAToken}`);
      193 |
    > 194 |       expect(response.status).toBe(HttpStatus.NOT_FOUND);
          |                               ^
      195 |       expect(response.body.message).toBe('Tag not found');
      196 |     });
      197 |   });

      at Object.<anonymous> (tags.e2e-spec.ts:194:31)

  ● TagsModule (e2e) › PATCH /api/tags/:id › [Sukses] Pengguna A memperbarui tag miliknya.

    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tags.e2e-spec.ts:55:21)

  ● TagsModule (e2e) › PATCH /api/tags/:id › [Gagal] Pengguna B mencoba memperbarui tag milik Pengguna A.
    TypeError: Cannot read properties of null (reading 'id')

      53 |       where: { email: userARegisterDto.email },
      54 |     });
    > 55 |     userAId = userA.id;
         |                     ^
      56 |
      57 |     // Register and login User B
      58 |     await registerUser(app, userBRegisterDto);

      at Object.<anonymous> (tags.e2e-spec.ts:55:21)

  ● TagsModule (e2e) › PATCH /api/tags/:id › [Gagal] Memperbarui tag yang tidak ada.

    expect(received).toBe(expected) // Object.is equality

    Expected: 404
    Received: 401

      239 |         .send(updateTagDto);
      240 |
    > 241 |       expect(response.status).toBe(HttpStatus.NOT_FOUND);
          |                               ^
      242 |       expect(response.body.message).toBe('Tag not found');
      243 |     });
      244 |

      at Object.<anonymous> (tags.e2e-spec.ts:241:31)

  ● TagsModule (e2e) › PATCH /api/tags/:id › [Gagal] Memperbarui dengan nama tag duplikat untuk pengguna 
yang sama.

    expect(received).toBe(expected) // Object.is equality

    Expected: 409
    Received: 500

      256 |         .send(updateTagDto);
      257 |
    > 258 |       expect(response.status).toBe(HttpStatus.CONFLICT);
          |                               ^
      259 |       expect(response.body.message).toBe(
      260 |         'Tag with this name already exists for this user',
      261 |       );

      at Object.<anonymous> (tags.e2e-spec.ts:258:31)

  ● TagsModule (e2e) › DELETE /api/tags/:id › [Sukses] Pengguna A menghapus tag miliknya.

    expect(received).toBe(expected) // Object.is equality

    Expected: 204
    Received: 500

      279 |         .set('Authorization', `Bearer ${userAToken}`);
      280 |
    > 281 |       expect(response.status).toBe(HttpStatus.NO_CONTENT);
          |                               ^
      282 |
      283 |       // Verify the tag is deleted
      284 |       const getResponse = await request(app.getHttpServer())

      at Object.<anonymous> (tags.e2e-spec.ts:281:31)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › POST /api/tags/:tagId/tasks/:taskId › [Sukses] Mengaitkan tag milik Pengguna A dengan tugas milik Pengguna A.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › POST /api/tags/:tagId/tasks/:taskId › [Gagal] Mengaitkan dengan ID tugas atau ID tag yang tidak valid.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › POST /api/tags/:tagId/tasks/:taskId › [Gagal] Mengaitkan tag milik Pengguna A dengan tugas milik Pengguna B.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › POST /api/tags/:tagId/tasks/:taskId › [Gagal] Mengaitkan tanpa token autentikasi.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › DELETE /api/tags/:tagId/tasks/:taskId › [Sukses] Melepaskan asosiasi tag dari tugas.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › DELETE /api/tags/:tagId/tasks/:taskId › [Gagal] Melepaskan asosiasi dengan ID tugas atau ID tag yang tidak valid.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

  ● TagsModule (e2e) › Suite Pengujian: Asosiasi Tugas-Tag (/api/tags/.../tasks/...) › DELETE /api/tags/:tagId/tasks/:taskId › [Gagal] Melepaskan asosiasi tanpa token autentikasi.

    ReferenceError: createTaskBBResponse is not defined

      332 |         .set('Authorization', `Bearer ${userBToken}`)
      333 |         .send({ title: 'User B Task for Tagging' });
    > 334 |       userBTaskId = createTaskBBResponse.body.id;
          |       ^
      335 |     });
      336 |
      337 |     describe('POST /api/tags/:tagId/tasks/:taskId', () => {

      at Object.<anonymous> (tags.e2e-spec.ts:334:7)

Test Suites: 3 failed, 2 passed, 5 total
Tests:       28 failed, 26 passed, 54 total
Snapshots:   0 total
Time:        41.488 s
Ran all test suites.